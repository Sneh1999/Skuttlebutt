var pull = require('pull-stream')

require('ssb-client')(function (err, sbot) {
  var times = {}, last = {}
  var c = 0
  var timetravel = []
  pull(
    sbot.createLogStream(),
    pull.drain(function (data) {
      var id = data.value.author
      if(times[id] && times[id] > data.value.timestamp) {
        if(last[id].value.sequence < data.value.sequence) {
          timetravel.push([last[id], data])
          console.error([last[id], data])
        }
      }
      else {
        c++
        times[id] = data.value.timestamp
        last[id] = data
        if(!(c % 1000)) console.error(c)
      }
    }, function () {
      sbot.close()
      console.log(JSON.stringify(timetravel, null, 2))
    })
  )
})
